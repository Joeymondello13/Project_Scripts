import copy
import numpy as np
import matplotlib
import matplotlib.pyplot as plt
import os
import seaborn as sns
import sys
if __name__ == '__main__':
    a = np.array([[3.936580976365378, 3.636958625911628, 4.210971736340252, 4.287665081696059, 4.068548701840678, 3.943977385072229, 3.744397618594919, 4.006244181324861, 3.5657588823862425, 4.074117773234377, 4.033285081493653, 4.025964541673218, 3.726619150519051],
    [4.436589328726382, 4.284872064172524, 4.785128242750295, 4.825885285392097, 4.610991718057256, 4.59520720738985, 4.151730423199605, 4.524209196736525, 4.104955162871904, 4.6317689899026, 4.510176955367719, 4.486212220554956, 4.4387109423858915],
    [4.627383796411722, 4.360431842188497, 4.644364799740479, 4.734676712895108, 4.476413609057441, 4.650465219354649, 4.445683791696593, 4.596733589585001, 4.228275261391506, 4.833724172488488, 4.584085770531179, 4.675439986655328, 4.468145311578146],
    [4.741625059867894, 4.5470066274333325, 4.786894896236027, 4.731482038505768, 4.625387499106249, 4.913004750595317, 4.550792813736855, 4.730666738189443, 4.399431426372132, 5.039426767500871, 4.691542376594222, 4.849059394821113, 4.687776675948799],
    [4.5514193623660475, 4.46359587482463, 4.922355268434831, 4.919194460993616, 4.734084551500051, 4.804473868268794, 4.302178108404217, 4.626105241172626, 4.2204581145958855, 4.758560334915279, 4.660374444600706, 4.578510583899363, 4.503786739890675],
    [4.199568545239124, 4.0512641015452955, 4.254378728911302, 4.42951352903749, 4.098876433499992, 4.257510648399902, 4.015417421775432, 4.242423642574021, 3.8036966700005634, 4.3721643643405175, 4.1374145523901, 4.233606739718749, 4.0659008398441046],
    [3.6105602159230292, 3.41686878627668, 3.770899859517987, 3.944779238854648, 3.6578867422558017, 3.6115163591350936, 3.336426716473568, 3.689946640417024, 2.9847621887252487, 3.87440561923853, 3.6472810054147313, 3.621817746664895, 3.3937051771444877],
    [4.272201068431692, 4.092775736675196, 4.331497714019868, 4.390565954300581, 4.202136266065851, 4.4036914479920295, 4.150224725271109, 4.2745730512158895, 4.02008981276044, 4.4937024601812565, 4.228157705548259, 4.401313147757046, 4.263768213319658],
    [4.04856498257199, 3.854892682783057, 4.279038733544284, 4.363099365999505, 4.167904810207999, 4.135781961314799, 3.9367407949256794, 4.024747194458852, 3.7218002998643396, 4.277129340323099, 4.214733391248642, 4.234968090610089, 3.9826770130733355],
    [3.4039097709923625, 3.339737914206889, 3.4882361011890235, 3.5886014127350134, 3.4452814767147504, 3.534358795512594, 3.355986258725539, 3.500552096011394, 3.172785376124441, 3.6825291455386413, 3.48711418171057, 3.4983009292125002, 3.403999920272422],
    [3.5687277163192292, 3.4354610533782552, 3.741286934139309, 3.8734609975853194, 3.657724685733679, 3.641993052283307, 3.258999394825816, 3.6313816449189837, 3.049957845083677, 3.7744039724910516, 3.633591073731752, 3.5970169977480233, 3.4426223348283584]])

    b = np.array([[4.395942347554475, 4.014674500839934, 4.650205539412547, 4.749117627987947, 4.481670085063727, 4.360514382891607, 4.189125707895608, 4.418842056597747, 3.984656765230463, 4.531580596761035, 4.47512507290869, 4.487498009718571, 4.116733758549889],
[5.236123778073917, 4.921845017098266, 5.240098163201582, 5.352546808604935, 5.064941334480689, 5.220938360996783, 5.047776576280177, 5.198381987698115, 4.83970734403803, 5.448669842323181, 5.185614745394844, 5.28467048060175, 5.016287222635059],
[4.940593541780443, 4.766781438559078, 5.255179604842019, 5.305096320563085, 5.0904393654376445, 5.075560659659501, 4.630461825161118, 5.000411963043834, 4.577225002429484, 5.141742826296799, 5.022718103121154, 4.983873721255901, 4.885019220945889],
[5.288118662376675, 4.993688747164966, 5.280134547284211, 5.2271438533748364, 5.102845476341339, 5.388371352432365, 5.053715240070634, 5.212158896099339, 4.889468364763211, 5.558570352633492, 5.204276602047697, 5.379591494143339, 5.162688668832213],
[5.12349316496013, 4.995203586788543, 5.468574975600854, 5.458428869104275, 5.227618612705723, 5.342756744523384, 4.848031457378483, 5.118749354713352, 4.7633767431036755, 5.351253313393419, 5.223189854105402, 5.167741866297087, 5.0464627739508],
[4.756081985234494, 4.522467253638686, 4.775505694345416, 4.959740288150494, 4.6007642341506125, 4.755198908420305, 4.537286495602311, 4.756941783594825, 4.3166986172963115, 4.976571979948993, 4.681322115767365, 4.800988605863867, 4.576008735397082],
[4.165576331525595, 3.886129812035124, 4.297416311026662, 4.478021906040551, 4.155985572984548, 4.10739584981255, 3.8344097675507296, 4.169711080251346, 3.4699010928377114, 4.431203175792672, 4.196549103651873, 4.1624505787026465, 3.8699013828204234],
[4.878299896794208, 4.640598731749244, 4.900516366110868, 4.972181838631315, 4.762716462301921, 4.946426589165014, 4.703998827787705, 4.843834615347053, 4.561898309169973, 5.075656657367044, 4.802796502635272, 4.969840036878282, 4.7744045320192905],
[4.538429484970838, 4.282354355474255, 4.740915008918088, 4.842773903442667, 4.6123539747216515, 4.591211378676731, 4.398629796159718, 4.468111745316786, 4.156261515783903, 4.795674169929811, 4.689266499279087, 4.728995691336513, 4.428680068598224],
[4.024404097660788, 3.853620448328921, 4.0563751806206, 4.151221346229546, 3.9554004059557526, 4.066588334905348, 3.9209862806060816, 4.042481011836054, 3.695403648016433, 4.28079267225348, 4.063737636590571, 4.068444308660725, 3.9224298783848868],
[4.08499351292933, 3.8874664406826636, 4.240693390079923, 4.389690972882769, 4.128000813065022, 4.125733037227992, 3.7649096040157675, 4.1266058094147295, 3.546670486829378, 4.308403098498098, 4.174020869829032, 4.12944725961596, 3.881921914391782]])

    tica = np.array([[1.7291952771560524, 1.8966771744157347, 2.0301262645166878, 2.1182408136475894, 2.009840829482972, 1.9143579586418327, 2.019394902344778, 1.995008045203988, 2.200557231875672, 1.962216896270462, 1.9309661535715823, 2.470948083787956, 2.0911024340028495],
[1.7644487384094094, 1.96171851166268, 2.126957842882384, 2.181124626754758, 2.077960475513201, 1.9710027649145987, 2.081132265263188, 2.0577789942169704, 2.2839877677334024, 2.0230778503917817, 1.9808238013039867, 2.516078160461383, 2.1601581088593584],
[1.7291952771560524, 1.8966771744157347, 2.0301262645166878, 2.1182408136475894, 2.009840829482972, 1.9143579586418327, 2.019394902344778, 1.995008045203988, 2.200557231875672, 1.962216896270462, 1.9309661535715823, 2.470948083787956, 2.0911024340028495],
[2.6832167745770805, 2.6859698837904116, 2.928630296086302, 3.035148505641998, 2.90058195647797, 2.7093059174490417, 2.872854900529239, 2.891904193472681, 2.9510681343091036, 2.81039085532558, 2.8728466825980163, 3.085632790260941, 2.9331901397093905],
[1.476972640506804, 1.5825437048762296, 1.8618691571575556, 1.9874880608853187, 1.8114982703342823, 1.540178814040438, 1.832313802635783, 1.7797795322048144, 1.997619176431808, 1.5813511774263482, 1.712128863393173, 2.2743716978245625, 1.9295924207411237],
[1.375393538480908, 1.8181024122928389, 2.0817496912885214, 2.158592350610232, 1.9332957453097745, 1.8509560105046847, 2.0513880607205093, 1.9105072358101685, 2.270880114889472, 1.6701692171243598, 1.9162512721666929, 2.5477041459112386, 2.1293263450971573],
[1.375393538480908, 1.8181024122928389, 2.0817496912885214, 2.158592350610232, 1.9332957453097745, 1.8509560105046847, 2.0513880607205093, 1.9105072358101685, 2.270880114889472, 1.6701692171243598, 1.9162512721666929, 2.5477041459112386, 2.1293263450971573],
[1.3576797545225814, 1.662972674346715, 1.983128240565597, 2.128387172157686, 1.903650003484367, 1.7116995131601362, 1.9911433461564034, 1.8607998892953104, 2.174964555441572, 1.6672148435003282, 1.869474602394166, 2.4594296789604546, 2.0669134259912165],
[1.3576797545225814, 1.662972674346715, 1.983128240565597, 2.128387172157686, 1.903650003484367, 1.7116995131601362, 1.9911433461564034, 1.8607998892953104, 2.174964555441572, 1.6672148435003282, 1.869474602394166, 2.4594296789604546, 2.0669134259912165],
[1.7644487384094094, 1.96171851166268, 2.126957842882384, 2.181124626754758, 2.077960475513201, 1.9710027649145987, 2.081132265263188, 2.0577789942169704, 2.2839877677334024, 2.0230778503917817, 1.9808238013039867, 2.516078160461383, 2.1601581088593584]])

    pca = np.array([[2.336780296789623, 1.922916512105368, 2.0690630965939962, 2.1936076907699755, 1.9989096096007901, 2.304553987256232, 2.7005548989071517, 2.170464634971054, 2.0456017774609543],
[2.395105384595597,2.042266419311459, 2.150380279771869, 2.2639707466854806, 2.053140107596108, 2.3399712242130453, 2.7336208663259978, 2.240943281204272, 2.158662158142413],
[2.336780296789623, 1.922916512105368,2.0690630965939962, 2.1936076907699755, 1.9989096096007901, 2.304553987256232, 2.7005548989071517, 2.170464634971054, 2.0456017774609543],
[3.1664362393438914, 2.8829590259964575, 2.9564425160562897,3.0788879338615547, 2.913452070394355, 3.0720126445847065, 3.6038215166256116, 3.0435366555066765, 2.9811990267702932],
[2.3065520174826704, 1.7779128465006937, 1.856470786375032, 2.0318764409478387,1.9464520691244034, 2.056083922707406, 2.8169300949210685, 1.9386271585445234, 1.883651077667239],
[2.4370943552566358, 1.95293279752723, 1.9656716995644037, 2.155856224501338, 1.971633422164506,2.1431057712430643, 2.899134784833136, 2.1178176967678457, 2.1601290141050282],
[2.4370943552566358, 1.95293279752723, 1.9656716995644037, 2.155856224501338, 1.971633422164506, 2.1431057712430643,2.899134784833136, 2.1178176967678457, 2.1601290141050282],
[2.4247769217884825, 1.9196959455358407, 1.9696358622574224, 2.1889321610552956, 1.9512176472353289, 2.147120477906857, 2.907030119477649,2.1227983519431057, 2.0679484419288294],
[2.4247769217884825, 1.9196959455358407, 1.9696358622574224, 2.1889321610552956, 1.9512176472353289, 2.147120477906857, 2.907030119477649, 2.1227983519431057,2.0679484419288294],
[2.395105384595597, 2.042266419311459, 2.150380279771869, 2.2639707466854806, 2.053140107596108, 2.3399712242130453, 2.7336208663259978, 2.240943281204272, 2.158662158142413]])

    charmm = np.array([[3.209109861005309, 3.4407402749437552, 2.9982642306551326, 2.5890729513565756, 2.833670848746365, 3.7627206621724185, 4.068253465260887, 3.9493660348889077, 2.779831404258963, 2.7246132606394773, 3.2246289998818183, 3.4630370132073667, 2.6811512891758444, 4.090160897449293],
[3.234902787653719, 3.4628314602676102, 2.9938781770655623, 2.6367944849670146, 2.8946676989668787, 3.7762807816692203, 4.101678821290117, 3.964558978285815, 2.811317726179386, 2.757843255762894, 3.2583404916738212, 3.475150192153341, 2.7104792110751976,4.117614140386523],
[3.209109861005309, 3.4407402749437552, 2.9982642306551326, 2.5890729513565756, 2.833670848746365, 3.7627206621724185, 4.068253465260887, 3.9493660348889077, 2.779831404258963, 2.7246132606394773, 3.2246289998818183, 3.4630370132073667, 2.6811512891758444,4.090160897449293],
[3.14006859881079, 3.4756490716410666, 2.430036777988611, 2.174555482591278, 2.806008495655366, 3.5058348659435317, 4.003478372591365, 3.989441519878753, 2.132405301369651, 2.833135014960351, 3.2964055070435645, 3.238139385978502, 3.001849483968463,3.622019416841082],
[3.6814509634793064, 3.818914532755536, 3.261823369909702, 2.833129435052026, 2.9396140004369795, 3.8914547938789177, 4.448903166980043, 3.933400645438102, 3.072548142111951, 2.8068398663992644, 3.2313425582378694, 3.9026978815031024, 2.6741913539535274,4.4472665745786735],
[3.7361332470888677, 3.864784618641762, 3.3084076435464453, 2.7898123524779113, 3.059300927293132, 3.9891452710331405, 4.50050327275904, 4.181761832483079, 3.0224076016336543, 2.880326269768428, 3.3934269311180016, 3.954491908755547, 2.8410866473222347,4.580376062796132],
[3.7361332470888677, 3.864784618641762, 3.3084076435464453, 2.7898123524779113, 3.059300927293132, 3.9891452710331405, 4.50050327275904, 4.181761832483079, 3.0224076016336543, 2.880326269768428, 3.3934269311180016, 3.954491908755547, 2.8410866473222347,4.580376062796132],
[3.713824335574199, 3.8836951356262794, 3.32617585531411, 2.8074240732792393, 3.0663657808390927, 3.9361899869587997, 4.480117210335029, 4.163032143976153, 3.04356059657082, 2.8717704838217775, 3.3081883827220007, 3.9354847977024616, 2.7859526979686247,4.552172566138296],
[3.713824335574199, 3.8836951356262794, 3.32617585531411, 2.8074240732792393, 3.0663657808390927, 3.9361899869587997, 4.480117210335029, 4.163032143976153, 3.04356059657082, 2.8717704838217775, 3.3081883827220007, 3.9354847977024616, 2.7859526979686247,4.552172566138296],
[3.234902787653719, 3.4628314602676102, 2.9938781770655623, 2.6367944849670146, 2.8946676989668787, 3.7762807816692203, 4.101678821290117, 3.964558978285815, 2.811317726179386, 2.757843255762894, 3.2583404916738212, 3.475150192153341, 2.7104792110751976,4.117614140386523]])

    gromos = np.array([[4.261918872834815, 4.564762309071239, 5.060875424069165, 4.984717966196849, 4.7262286790842465, 4.538260231482018, 3.8917450125864597, 4.6551352433512685, 4.466532176306471, 3.9674907759356888,3.811408553966694],
[4.220144731260819, 4.600496129177673, 5.1058375178620805, 5.024860862722172, 4.760693510988471, 4.6138708324855, 3.8833969687677907, 4.712064243512783, 4.4496216908859,4.017458466310771, 3.836960330285125],
[4.261918872834815,4.564762309071239, 5.060875424069165, 4.984717966196849, 4.7262286790842465, 4.538260231482018, 3.8917450125864597, 4.6551352433512685,4.466532176306471, 3.9674907759356888, 3.811408553966694],
[4.119707336687476,4.222628644274581, 4.730632946526265, 4.697429063116897, 4.572574976519283, 4.23816759343415, 3.6366976463232605,4.389493681051151, 4.273731208927758, 3.769341384796269, 3.746619553539685],
[4.627736423885318, 4.934211893748706, 5.410296677403121, 5.3199552641075405, 5.1218260507752476, 4.944252211409394,4.317803069070105, 4.9976116443438245, 4.764983551120581, 4.362914776482176, 4.164634703168287],
[4.60704524028983, 4.891667560736443, 5.393232743414652, 5.416883572271328, 5.104137535695473,4.887254681209968, 4.21375002689614, 5.019471349443944, 4.688856397573862, 4.322985865098374, 4.142544904376245],
[4.60704524028983, 4.891667560736443, 5.393232743414652, 5.416883572271328, 5.104137535695473, 4.887254681209968, 4.21375002689614, 5.019471349443944, 4.688856397573862, 4.322985865098374, 4.142544904376245],
[4.641732467505687, 4.939927476151524, 5.434564859981098,5.40091962035036, 5.091427518103232, 4.920750424587835, 4.2769978630175105, 5.031484834751137, 4.74267638163029, 4.38099955851554, 4.1682181434060155],
[4.641732467505687, 4.939927476151524, 5.434564859981098, 5.40091962035036, 5.091427518103232, 4.920750424587835, 4.2769978630175105, 5.031484834751137, 4.74267638163029, 4.38099955851554, 4.1682181434060155],
[4.220144731260819, 4.600496129177673, 5.1058375178620805, 5.024860862722172, 4.760693510988471, 4.6138708324855, 3.8833969687677907, 4.712064243512783, 4.4496216908859, 4.017458466310771, 3.836960330285125]])

    our_pca = np.array([[2.336780296789623, 1.922916512105368, 2.0690630965939962, 2.1936076907699755, 2.7005548989071517, 2.019955384992514, 2.304553987256232, 2.170464634971054, 2.0456017774609543],
[2.395105384595597, 2.042266419311459, 2.150380279771869, 2.2639707466854806, 2.7336208663259978, 2.115175688146984, 2.3399712242130453, 2.240943281204272, 2.158662158142413],
[2.336780296789623, 1.922916512105368, 2.0690630965939962, 2.1936076907699755, 2.7005548989071517, 2.019955384992514, 2.304553987256232, 2.170464634971054, 2.0456017774609543],
[3.1664362393438914, 2.8829590259964575, 2.9564425160562897, 3.0788879338615547, 3.6038215166256116, 2.963447576958449, 3.0720126445847065, 3.0435366555066765, 2.9811990267702932],
[2.3065520174826704, 1.7779128465006937, 1.856470786375032, 2.0318764409478387, 2.8169300949210685, 1.976162140405097, 2.056083922707406, 1.9386271585445234, 1.883651077667239],
[2.4370943552566358, 1.95293279752723, 1.9656716995644037, 2.155856224501338, 2.899134784833136, 2.1353483201598578, 2.1431057712430643, 2.1178176967678457, 2.1601290141050282],
[2.4370943552566358, 1.95293279752723, 1.9656716995644037, 2.155856224501338, 2.899134784833136, 2.1353483201598578, 2.1431057712430643, 2.1178176967678457, 2.1601290141050282],
[2.4247769217884825, 1.9196959455358407, 1.9696358622574224, 2.1889321610552956, 2.907030119477649, 2.0819231078160705, 2.147120477906857, 2.1227983519431057, 2.0679484419288294],
[2.4247769217884825, 1.9196959455358407, 1.9696358622574224, 2.1889321610552956, 2.907030119477649, 2.0819231078160705, 2.147120477906857, 2.1227983519431057, 2.0679484419288294],
[2.395105384595597, 2.042266419311459, 2.150380279771869, 2.2639707466854806, 2.7336208663259978, 2.115175688146984, 2.3399712242130453, 2.240943281204272, 2.158662158142413] ])
    # print(np.average(gromos))
    # print(np.average(charmm))
    # print(np.average(pca))
    # print(np.average(tica))
    print(np.average(our_pca))
    pdb_files1 = os.listdir('pdb_files1')
    pdb_files2 = os.listdir('pdb_files2')
    ax = sns.heatmap(our_pca, vmin=0, vmax=6,cbar_kws={'label': 'Root Mean Square Deviation'})
    plt.xlabel('Representative Conformations Using PCA')
    plt.ylabel('Crystal Conformations')
    plt.show()
